<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>dependency-injection: dependency-injection</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">dependency-injection
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">dependency-injection </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Provides IoC dependency injection. Works on top of beatthat/services which provides the container itself</p>
<h2>Install</h2>
<p>From your unity project folder: </p><pre class="fragment">npm init
npm install TEMPLATE --save
echo Assets/packages &gt;&gt; .gitignore
echo Assets/packages.meta &gt;&gt; .gitignore
</pre><p>The package and all its dependencies will be installed under Assets/Plugins/packages.</p>
<p>In case it helps, a quick video of the above: <a href="https://youtu.be/Uss_yOiLNw8">https://youtu.be/Uss_yOiLNw8</a></p>
<h2>USAGE</h2>
<p>First, any service you want to use must be registered.</p>
<h4>Register Services to make them available for dependency injection and lookup.</h4>
<p>The simplest way to register a service is with the [RegisterService] attribute</p>
<div class="fragment"><div class="line">{c#}</div><div class="line">using BeatThat.Services;</div><div class="line">[RegisterService]public class Foo {}</div><div class="line"></div><div class="line">public class UsesLookup</div><div class="line">{</div><div class="line">    void MyMethod()</div><div class="line">    {</div><div class="line">        // any service that is registered</div><div class="line">        // can be looked up directly</div><div class="line">        var foo = Services.Require&lt;Foo&gt;();</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h4>Use [Inject] for cleaner code and less tight coupling</h4>
<p>Dependency injection is a cleaner way to use services. It has a smaller code footprint and less direct dependencies on BeatThat.Services code. Down the road, if you wanted to switch to some other IoC container it would be easier to hack a patch to work with [Inject] tags than, say, Services.Require&lt;SomeClass&gt; calls.</p>
<div class="fragment"><div class="line">{c#}</div><div class="line">using BeatThat.Services;</div><div class="line">[RegisterService]public class Foo{}</div><div class="line"></div><div class="line">public class UsesInjection_Manual</div><div class="line">{</div><div class="line">    [Inject]Foo myFoo; // will be set by injection</div><div class="line"></div><div class="line">    void Start()</div><div class="line">    {</div><div class="line">        // Something needs to call DependencyInjection.InjectDependencies.</div><div class="line">        // One option is to call it in Start...</div><div class="line">        DependencyInjection.InjectDependencies(this);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>...the above example still directly calls DependencyInjection.InjectDependencies. You can better contain that dependency by using a base class. One also comes provided</p>
<div class="fragment"><div class="line">{c#}</div><div class="line">using BeatThat.Services;</div><div class="line">[RegisterService]public class Foo{}</div><div class="line"></div><div class="line">public class UsesInjection_WithBaseClass : DependencyInjectedBehaviour</div><div class="line">{</div><div class="line">    [Inject]Foo myFoo; // will be set by injection</div><div class="line">}</div></div><!-- fragment --><h4>Use interfaces for less tight coupling and easier refactoring</h4>
<p>It's generally a good idea to use narrow interfaces for services to avoid tight coupling. More concretely, accessing services as interfaces makes it easier to swap the implementation, and, assuming the service interfaces are narrowly defined, also makes it much easier to understand at a glance what your service-dependent code really depends upon. This can be a big time saver when you're refactoring and using tools like 'Find References' to try to go through all the classes that depend on some service.</p>
<p>The [RegisterService] attribute provides a couple of features to make it easier to use interfaces.</p>
<h6>Use injection freely on interfaces defined directly on the service class</h6>
<p>```c# using BeatThat.Services; public interface Bar {}</p>
<p>[RegisterService]public class Foo : Bar {}</p>
<p>public class UsesBar : DependencyInjectedBehaviour { [Inject]Bar myBar; // will be set by injection to Foo } </p><div class="fragment"><div class="line">###### Use &#39;proxyInterfaces&#39; to register interfaces further up the chain</div><div class="line"></div><div class="line">```c#</div><div class="line">using BeatThat.Services;</div><div class="line">public interface Bar {}</div><div class="line"></div><div class="line">public class FooBase : Bar {}</div><div class="line"></div><div class="line">[RegisterService(</div><div class="line">    // interface Bar will not be auto registered</div><div class="line">    // because it is not defined directly on class Foo</div><div class="line">    proxyInterfaces: new System.Type[] { typeof(Bar) }</div><div class="line">)]</div><div class="line">public class Foo : FooBase {}</div><div class="line"></div><div class="line">public class UsesBar : DependencyInjectedBehaviour</div><div class="line">{</div><div class="line">    [Inject]Bar myBar; // will be set by injection to Foo</div><div class="line">}</div></div><!-- fragment --><h6>Use 'interfaceRegistrationPolicy' to just register all interfaces</h6>
<p>```c# using BeatThat.Services; public interface Bar {}</p>
<p>public class FooBase : Bar {}</p>
<p>[RegisterService( // register all interfaces on class and parents interfaceRegistrationPolicy: InterfaceRegistrationPolicy.RegisterInterfacesDeclaredOnTypeAndParents )] public class Foo : FooBase {}</p>
<p>public class UsesBar : DependencyInjectedBehaviour { [Inject]Bar myBar; // will be set by injection to Foo } ````</p>
<h2>SAMPLES</h2>
<p>This package installs with a Samples that has a few basic examples that demonstrate how to use services, dependency injection etc.</p>
<p>Each Sample also has a short video covering what's going on in the example.</p>
<ul>
<li>Example_01_DependencyInjection: <a href="https://youtu.be/oaZdGZ98fdA">https://youtu.be/oaZdGZ98fdA</a> </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
